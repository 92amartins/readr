PKG_CXXFLAGS = -I. -Iwritecon
PKG_LIBS = -L. -lcon2 -L../inst/writecon -Wl,-rpath,$(R_PACKAGE_DIR)/writecon

all: $(SHLIB)

$(SHLIB): ../inst/writecon/libcon2.so

UNAME:=$(shell uname -s)
ifeq ($(UNAME), Darwin)
../inst/writecon/libcon2.so: writecon/connection.o
	$(SHLIB_LINK) -o $@ $^ -Wl,-install_name -Wl,@loader_path/../writecon/libcon2.so
else
../inst/writecon/libcon2.so: writecon/connection.o
	$(SHLIB_LINK) -o $@ $^
endif

clean:
	rm -f writecon/connection.o ../inst/writecon/libcon2.so
